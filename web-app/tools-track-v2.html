<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tools Track - ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å</title>
    
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js';
        import { 
            getFirestore, 
            collection, 
            getDocs, 
            query, 
            where, 
            orderBy,
            Timestamp 
        } from 'https://www.gstatic.com/firebasejs/10.0.0/firebase-firestore.js';
        import { 
            getAuth, 
            signInWithPopup, 
            GoogleAuthProvider, 
            onAuthStateChanged,
            signOut 
        } from 'https://www.gstatic.com/firebasejs/10.0.0/firebase-auth.js';

        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "your-api-key-here",
            authDomain: "my-database-project.firebaseapp.com", 
            projectId: "my-database-project",
            storageBucket: "my-database-project.appspot.com",
            messagingSenderId: "your-messaging-sender-id",
            appId: "your-app-id-here"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        // Make Firebase available globally
        window.db = db;
        window.auth = auth;
        window.provider = provider;
        window.firebaseModules = {
            collection,
            getDocs,
            query,
            where,
            orderBy,
            Timestamp,
            signInWithPopup,
            onAuthStateChanged,
            signOut
        };

        console.log('üî• Firebase initialized successfully!');
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }

        .header h1 {
            font-size: 28px;
            color: #333;
            margin-bottom: 5px;
        }

        .header p {
            color: #666;
            font-size: 16px;
        }

        /* Authentication Styles */
        .auth-container {
            text-align: center;
            padding: 50px 20px;
        }

        .auth-button {
            background: #4285f4;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
        }

        .auth-button:hover {
            background: #357ae8;
            transform: translateY(-2px);
        }

        .user-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #e8f5e8;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .user-name {
            font-weight: bold;
            color: #2d5a2d;
        }

        .logout-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        .navigation {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .nav-btn {
            padding: 10px 20px;
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            color: #333;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .nav-btn:hover, .nav-btn.active {
            background: #4285f4;
            color: white;
            border-color: #4285f4;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-number {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.9;
        }

        .requests-section {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 20px;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }

        .request-card {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .request-card:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .request-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .request-id {
            font-weight: bold;
            color: #333;
        }

        .request-date {
            color: #666;
            font-size: 14px;
        }

        .status-badge {
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .status-approved {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status-rejected {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status-returned {
            background: #cce5ff;
            color: #004085;
            border: 1px solid #b3d9ff;
        }

        .request-details {
            margin-bottom: 15px;
        }

        .detail-row {
            display: flex;
            margin-bottom: 5px;
        }

        .detail-label {
            font-weight: bold;
            min-width: 120px;
            color: #333;
        }

        .detail-value {
            color: #666;
        }

        .tools-list {
            background: white;
            border-radius: 5px;
            padding: 15px;
            margin-top: 10px;
        }

        .tools-table {
            width: 100%;
            border-collapse: collapse;
        }

        .tools-table th,
        .tools-table td {
            padding: 8px 12px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }

        .tools-table th {
            background: #f8f9fa;
            font-weight: bold;
            color: #333;
        }

        .no-requests {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .no-requests-icon {
            font-size: 48px;
            margin-bottom: 10px;
            opacity: 0.5;
        }

        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4285f4;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .hidden {
            display: none;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                padding: 20px;
            }

            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 10px;
            }

            .request-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .navigation {
                flex-direction: column;
            }

            .nav-btn {
                text-align: center;
            }

            .tools-table {
                font-size: 14px;
            }

            .detail-row {
                flex-direction: column;
            }

            .detail-label {
                min-width: auto;
                margin-bottom: 2px;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="container">
        <div class="header">
            <h1>üîç Tools Track</h1>
            <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
        </div>
        <div class="loading-spinner"></div>
    </div>

    <!-- Authentication Screen -->
    <div id="authScreen" class="container hidden">
        <div class="header">
            <h1>üîç Tools Track</h1>
            <p>‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠</p>
        </div>
        
        <div class="auth-container">
            <h3>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h3>
            <p style="margin: 20px 0;">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢ Google Account ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å</p>
            <button id="loginBtn" class="auth-button">
                <svg width="18" height="18" viewBox="0 0 18 18">
                    <path fill="#4285F4" d="M9,3.48c1.69,0,2.83,0.73,3.48,1.34l2.54-2.48C13.46,0.89,11.43,0,9,0C5.48,0,2.44,2.02,0.96,4.96l2.91,2.26C4.6,5.05,6.62,3.48,9,3.48z"/>
                    <path fill="#34A853" d="M17.64,9.2c0-0.74-0.06-1.28-0.19-1.84H9v3.34h4.96c-0.21,1.14-0.88,2.06-1.26,2.13v1.76h3.06C16.93,13.07,17.64,11.53,17.64,9.2z"/>
                    <path fill="#FBBC04" d="M3.88,10.78C3.58,9.92,3.58,8.08,3.88,7.22L0.96,4.96C0.35,6.18,0,7.55,0,9s0.35,2.82,0.96,4.04L3.88,10.78z"/>
                    <path fill="#EA4335" d="M9,18c2.43,0,4.47-0.8,5.96-2.18l-3.06-1.76c-0.8,0.53-1.82,0.84-2.9,0.84c-2.38,0-4.4-1.57-5.12-3.74L0.96,13.04C2.44,15.98,5.48,18,9,18z"/>
                </svg>
                ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢ Google
            </button>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="container hidden">
        <!-- User Info Bar -->
        <div id="userInfo" class="user-info">
            <span class="user-name" id="userName"></span>
            <button id="logoutBtn" class="logout-btn">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
        </div>

        <div class="header">
            <h1>üîç Tools Track</h1>
            <p>‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠</p>
        </div>

        <!-- Navigation -->
        <div class="navigation">
            <a href="tools-request-v2.html" class="nav-btn">üìù ‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠</a>
            <a href="tools-track-v2.html" class="nav-btn active">üîç ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</a>
            <a href="index.html" class="nav-btn">üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
        </div>

        <!-- Statistics -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="totalRequests">0</div>
                <div class="stat-label">‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="pendingRequests">0</div>
                <div class="stat-label">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="approvedRequests">0</div>
                <div class="stat-label">‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="borrowedTools">0</div>
                <div class="stat-label">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡∏°</div>
            </div>
        </div>

        <!-- Requests Section -->
        <div class="requests-section">
            <div class="section-title">üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</div>
            <div id="requestsList">
                <!-- Requests will be loaded here -->
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentUser = null;
        let userRequests = [];

        // Initialize app when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        async function initializeApp() {
            // Wait for Firebase modules to be available
            let attempts = 0;
            while (!window.firebaseModules && attempts < 50) {
                await new Promise(resolve => setTimeout(resolve, 100));
                attempts++;
            }

            if (!window.firebaseModules) {
                console.error('Firebase modules not loaded');
                return;
            }

            // Setup authentication listener
            window.firebaseModules.onAuthStateChanged(window.auth, (user) => {
                if (user) {
                    currentUser = user;
                    showMainApp();
                    loadUserRequests();
                } else {
                    showAuthScreen();
                }
                hideLoadingScreen();
            });

            // Setup login button
            document.getElementById('loginBtn').addEventListener('click', signInWithGoogle);
            document.getElementById('logoutBtn').addEventListener('click', signOutUser);
        }

        function hideLoadingScreen() {
            document.getElementById('loadingScreen').classList.add('hidden');
        }

        function showAuthScreen() {
            document.getElementById('authScreen').classList.remove('hidden');
            document.getElementById('mainApp').classList.add('hidden');
        }

        function showMainApp() {
            document.getElementById('authScreen').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            document.getElementById('userName').textContent = currentUser.displayName;
        }

        async function signInWithGoogle() {
            try {
                await window.firebaseModules.signInWithPopup(window.auth, window.provider);
            } catch (error) {
                console.error('Login error:', error);
                alert('‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ' + error.message);
            }
        }

        async function signOutUser() {
            try {
                await window.firebaseModules.signOut(window.auth);
            } catch (error) {
                console.error('Logout error:', error);
            }
        }

        async function loadUserRequests() {
            try {
                // Query requests for current user
                const requestsQuery = window.firebaseModules.query(
                    window.firebaseModules.collection(window.db, 'tool_requests'),
                    window.firebaseModules.where('requester_email', '==', currentUser.email),
                    window.firebaseModules.orderBy('created_at', 'desc')
                );

                const querySnapshot = await window.firebaseModules.getDocs(requestsQuery);
                
                userRequests = [];
                querySnapshot.forEach((doc) => {
                    userRequests.push({ id: doc.id, ...doc.data() });
                });

                console.log('Loaded user requests:', userRequests.length);
                
                updateStatistics();
                displayRequests();
                
            } catch (error) {
                console.error('Error loading user requests:', error);
                
                // Fallback to mock data for testing
                userRequests = [
                    {
                        id: 'mock-1',
                        employee: {
                            name: '‡∏ú‡∏π‡πâ‡∏ó‡∏î‡∏™‡∏≠‡∏ö',
                            department: '‡∏á‡∏≤‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö'
                        },
                        project: '‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö',
                        tools: [
                            {
                                tool_name: '‡∏™‡∏ß‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏ü‡πâ‡∏≤',
                                old_code: 'T001',
                                quantity: 1,
                                note: '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô'
                            }
                        ],
                        status: 'pending',
                        created_at: { seconds: Date.now() / 1000 }
                    }
                ];
                
                updateStatistics();
                displayRequests();
            }
        }

        function updateStatistics() {
            const total = userRequests.length;
            const pending = userRequests.filter(req => req.status === 'pending').length;
            const approved = userRequests.filter(req => req.status === 'approved').length;
            const borrowed = userRequests.filter(req => req.status === 'approved' && !req.returned_at).length;

            document.getElementById('totalRequests').textContent = total;
            document.getElementById('pendingRequests').textContent = pending;
            document.getElementById('approvedRequests').textContent = approved;
            document.getElementById('borrowedTools').textContent = borrowed;
        }

        function displayRequests() {
            const requestsList = document.getElementById('requestsList');
            
            if (userRequests.length === 0) {
                requestsList.innerHTML = `
                    <div class="no-requests">
                        <div class="no-requests-icon">üìã</div>
                        <h3>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠</h3>
                        <p>‡∏Ñ‡∏•‡∏¥‡∏Å "‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠</p>
                    </div>
                `;
                return;
            }

            const requestsHTML = userRequests.map(request => {
                const createdDate = request.created_at && request.created_at.seconds 
                    ? new Date(request.created_at.seconds * 1000).toLocaleDateString('th-TH')
                    : '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà';

                const toolsHTML = request.tools && request.tools.length > 0
                    ? `
                        <div class="tools-list">
                            <strong>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠:</strong>
                            <table class="tools-table">
                                <thead>
                                    <tr>
                                        <th>No</th>
                                        <th>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠</th>
                                        <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                                        <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${request.tools.map((tool, index) => `
                                        <tr>
                                            <td>${index + 1}</td>
                                            <td>${tool.old_code || tool.tool_id || ''} - ${tool.tool_name}</td>
                                            <td>${tool.quantity}</td>
                                            <td>${tool.note || '-'}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    `
                    : '<p>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠</p>';

                return `
                    <div class="request-card">
                        <div class="request-header">
                            <div>
                                <div class="request-id">‡∏Ñ‡∏≥‡∏Ç‡∏≠: ${request.id}</div>
                                <div class="request-date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${createdDate}</div>
                            </div>
                            <div class="status-badge status-${request.status}">
                                ${getStatusText(request.status)}
                            </div>
                        </div>
                        
                        <div class="request-details">
                            <div class="detail-row">
                                <span class="detail-label">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô:</span>
                                <span class="detail-value">${request.employee?.name || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô:</span>
                                <span class="detail-value">${request.employee?.department || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£:</span>
                                <span class="detail-value">${request.project || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}</span>
                            </div>
                            ${request.admin_response ? `
                                <div class="detail-row">
                                    <span class="detail-label">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏à‡∏≤‡∏Å‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô:</span>
                                    <span class="detail-value">${request.admin_response}</span>
                                </div>
                            ` : ''}
                        </div>
                        
                        ${toolsHTML}
                    </div>
                `;
            }).join('');

            requestsList.innerHTML = requestsHTML;
        }

        function getStatusText(status) {
            const statusMap = {
                'pending': '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
                'approved': '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß',
                'rejected': '‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò',
                'returned': '‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß'
            };
            return statusMap[status] || status;
        }
    </script>
</body>
</html>